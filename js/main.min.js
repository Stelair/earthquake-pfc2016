function peticionAjax(e){console.log("Inicio Sismo");var e=e||"http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_hour.geojson";initMapa();var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState)if(t.status>=100&&t.status<=300)if(datos=JSON.parse(t.responseText),console.info("La solicitud se ha completado correctamente."),console.info(datos),null!==datos.length&&0!==datos.length){document.getElementById("sis_cargando").style.display="none";for(var e=0;e<datos.features.length;e++)dibujarMapa(datos.features[e])}else console.warn("No ha habido ningún simo !!!");else t.status>=400&&t.status<=600&&errorDatos(JSON.parse(t.responseText))},t.open("GET",e,!0),t.send()}function dibujarMapa(e){var t=[],a=e.geometry.coordinates,o=new google.maps.LatLng(a[1],a[0]),n=e.properties.title,r=dibujarHTML(e),s=new google.maps.InfoWindow({content:r,maxWidth:250}),i=new google.maps.Marker({position:o,map:map,title:n});i.addListener("click",function(){s.open(map,i)});var c=e.properties.mag,u={location:o,weight:Math.pow(2,c)};t.push(u);new google.maps.visualization.HeatmapLayer({data:t,dissipating:!1,map:map})}function dibujarHTML(e){var t="";return console.info(e.properties.title),t+='<div class="sis-info" id="'+e.properties.code+'">',t+="<h3>"+e.properties.place+"</h3>",t+="<ul>",t+="<li><p><strong>Magnitud </strong>"+e.properties.mag+"</p></li>",t+="<li><p><strong>Tipo </strong>"+e.properties.type+"</p></li>",t+="<li><p><strong>Hora </strong></p>",t+="<p>"+formatearFechaUTC(e.properties.time)+"</p>",t+="<p>"+formatearFechaMiZonaHoraria(e.properties.time)+"<span> (tu zona horaria)</span></p></li>",t+='<li><a class="sis-btn" href=" '+e.properties.url+'">Más información</a></li>',t+="</ul>",t+="</div>"}function formatearFechaUTC(e){var t=new Date(e),a={year:"numeric",month:"numeric",day:"numeric",timeZone:"UTC",timeZoneName:"short",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1},o=Intl.DateTimeFormat("es-ES",a).format(t);return console.log("Fecha UTC: "+o),o}function formatearFechaMiZonaHoraria(e){var t=new Date(e),a={year:"numeric",month:"numeric",day:"numeric",timeZoneName:"short",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1},o=t.toLocaleString("es-ES",a);return console.log("Fecha Local: "+o),o}function errorDatos(e){document.getElementById("sis_cargando").style.display="none",document.getElementById("sis_error").style.display="block",console.error("ERROR! 404",e)}function initMapa(){var e={lat:40.3964,lng:-3.7129},t={zoom:2,center:e,mapTypeId:google.maps.MapTypeId.HYBRID,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER},scaleControl:!0,disableDefaultUI:!0};map=new google.maps.Map(document.getElementById("map_epicenter"),t)}var datos,map,tiempoRefresco=36e5;window.setInterval(peticionAjax(),tiempoRefresco),document.getElementById("past_hour_m4").addEventListener("click",function(){var e="http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/4.5_hour.geojson";peticionAjax(e)}),document.getElementById("past_hour_m2").addEventListener("click",function(){var e="http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_hour.geojson";peticionAjax(e)}),document.getElementById("past_hour_m1").addEventListener("click",function(){var e="http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/1.0_hour.geojson";peticionAjax(e)}),document.getElementById("past_hour_all").addEventListener("click",function(){var e="http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_hour.geojson";peticionAjax(e)}),document.getElementById("past_day_m4").addEventListener("click",function(){var e="http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/4.5_day.geojson";peticionAjax(e)}),document.getElementById("past_day_m2").addEventListener("click",function(){var e="http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_day.geojson";peticionAjax(e)}),document.getElementById("past_day_m1").addEventListener("click",function(){var e="http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/1.0_day.geojson";peticionAjax(e)}),document.getElementById("past_day_all").addEventListener("click",function(){var e="http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson";peticionAjax(e)}),document.getElementById("past_7_days_m4").addEventListener("click",function(){}),document.getElementById("past_7_days_m2").addEventListener("click",function(){}),document.getElementById("past_7_days_m1").addEventListener("click",function(){}),document.getElementById("past_7_days_all").addEventListener("click",function(){}),document.getElementById("btn_cerrar").addEventListener("click",function(){document.getElementById("sis_error").style.display="none"});